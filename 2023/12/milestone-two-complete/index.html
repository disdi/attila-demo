<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Milestone 2 Complete</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="https://librecar.dev/2023/12/milestone-two-complete/" rel="canonical" />
  <!-- Feed -->
        <link href="https://librecar.dev/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Libre Car Full Atom Feed" />
          <link href="https://librecar.dev/feeds/nlnet.atom.xml" type="application/atom+xml" rel="alternate" title="Libre Car Categories Atom Feed" />

  <link href="https://librecar.dev/theme/css/style.css" type="text/css" rel="stylesheet" />

    <!-- CSS specified by the user -->


    <link href="https://librecar.dev/assets/css/myblog.css" type="text/css" rel="stylesheet" />

    <!-- Custom fonts -->
    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
    <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->



    <meta name="description" content="This is to update on completion of Milestone 2 of the project which involved communication on the CAN network with real CAN devices. The...">

    <meta name="author" content="disdi">

    <meta name="tags" content="Nlnet">




<!-- Open Graph -->
<meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="Libre Car"/>
<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Milestone 2 Complete"/>
<meta prefix="og: http://ogp.me/ns#" property="og:description" content="This is to update on completion of Milestone 2 of the project which involved communication on the CAN network with real CAN devices. The..."/>
<meta prefix="og: http://ogp.me/ns#" property="og:locale" content="en_US"/>
<meta prefix="og: http://ogp.me/ns#" property="og:url" content="https://librecar.dev/2023/12/milestone-two-complete/"/>
<meta prefix="og: http://ogp.me/ns#" property="og:type" content="article"/>
<meta prefix="og: http://ogp.me/ns#" property="article:published_time" content="2023-12-16 14:21:00+01:00"/>
<meta prefix="og: http://ogp.me/ns#" property="article:modified_time" content="2023-12-16 13:06:38.263983+01:00"/>
<meta prefix="og: http://ogp.me/ns#" property="article:author" content="https://librecar.dev/author/disdi/">
<meta prefix="og: http://ogp.me/ns#" property="article:section" content="Nlnet"/>
<meta prefix="og: http://ogp.me/ns#" property="article:tag" content="Nlnet"/>
<meta prefix="og: http://ogp.me/ns#" property="og:image" content="https://github.com/disdi/attila-demo/raw/main/content/assets/images/logo.png">

<!-- Twitter Card -->

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Milestone 2 Complete",
  "headline": "Milestone 2 Complete",
  "datePublished": "2023-12-16 14:21:00+01:00",
  "dateModified": "2023-12-16 13:06:38.263983+01:00",
  "author": {
    "@type": "Person",
    "name": "disdi",
    "url": "https://librecar.dev/author/disdi/"
  },
  "image": "https://librecar.dev/theme/images/post-bg.jpg",
  "url": "https://librecar.dev/2023/12/milestone-two-complete/",
  "description": "This is to update on completion of Milestone 2 of the project which involved communication on the CAN network with real CAN devices. The..."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>
          <li><a href="/" role="presentation">Home</a></li>
          <li><a href="https://disdi.github.io/librecar-milestone" role="presentation">Milestones</a></li>


    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" >
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="https://librecar.dev/" aria-label="Home" title="Home">
                  <i class="ic ic-arrow-left" aria-hidden="true"></i>
                  <span>Home</span>
                </a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button" aria-label="Menu">
              <i class="ic ic-menu" aria-hidden="true"></i>
              <span>Menu</span>
            </a>
          </span>
        </nav>
        <h1 class="post-title">Milestone 2 Complete</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="https://librecar.dev/author/disdi/">Disdi</a>
            | <time datetime="16 Dec 2023">16 Dec 2023</time>
        </span>
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <p>This is to update on completion of Milestone 2 of the project which involved communication on the CAN network with real CAN devices.</p>
<p>The major work done in this Milestone involved :</p>
<ol class="arabic">
<li><p class="first">Bring UP the CTUCAN device enumerated in first Milestone.
Update of Litex interfaces was needed to make CAN interface UP and running.</p>
<p>Refer : <a class="reference external" href="https://github.com/disdi/linux-on-litex-vexriscv/commit/b4c7c81e48d285977055b19cb08069af642ff516">https://github.com/disdi/linux-on-litex-vexriscv/commit/b4c7c81e48d285977055b19cb08069af642ff516</a></p>
</li>
<li><p class="first">Use ip utilites of linux which treats CAN as network device and make it up.
Support was added to buildroot to include needed utilities for CAN and make it part of bootup script.</p>
<p>Refer : <a class="reference external" href="https://github.com/disdi/linux-on-litex-vexriscv/commit/64ecd04d2eefc14753181dbf8a1bc65d09c65991">https://github.com/disdi/linux-on-litex-vexriscv/commit/64ecd04d2eefc14753181dbf8a1bc65d09c65991</a></p>
<p>Below image shows CAN bus coming up on system restart and can-utils is used for communication over CAN network :</p>
<p><a class="reference external" href="/assets/images/litex-can.png"><img alt="Image" src="/assets/images/litex-can.png" /></a></p>
</li>
<li><p class="first">Now when CAN IP is up, we needed a CAN transceiver to connect to CAN network. SN65HVD230 CAN Board is used for this purpose.</p>
<p><a class="reference external" href="/assets/images/SN65HVD230-CAN-Board-2.jpg"><img alt="Image6" src="/assets/images/SN65HVD230-CAN-Board-2.jpg" /></a></p>
<p>Refer : <a class="reference external" href="https://www.waveshare.com/sn65hvd230-can-board.htm">https://www.waveshare.com/sn65hvd230-can-board.htm</a></p>
<p>can_tx and canrx are are mapped to ck_io pins exposed on J4 of Arty Board.
<a class="reference external" href="https://github.com/disdi/linux-on-litex-vexriscv/blob/master/soc_linux.py#L34">https://github.com/disdi/linux-on-litex-vexriscv/blob/master/soc_linux.py#L34</a></p>
<p>They are connected to CAN RX and CAN TX of transceiver with 3.3V to power it. Connection between FPGA board and CAN transceiver is shown below :</p>
<p><a class="reference external" href="/assets/images/fpga-traceiver.jpeg"><img alt="Image2" src="/assets/images/fpga-traceiver.jpeg" /></a></p>
</li>
<li><p class="first">Considerable testing is done over different CAN devices to confirm CTUCAN IP is able to comunicate over CAN network.
PCAN-USB adapter is used to emulate CAN device over development computer.</p>
<p>Refer : <a class="reference external" href="https://www.peak-system.com/PCAN-USB.199.0.html?&amp;L=1">https://www.peak-system.com/PCAN-USB.199.0.html?&amp;L=1</a></p>
<p>Connection between PCAN-USB adapter with DB9 connector and CAN transceiver is shown below :</p>
<p><a class="reference external" href="/assets/images/tranciever-Pcanusb.jpeg"><img alt="Image3" src="/assets/images/tranciever-Pcanusb.jpeg" /></a></p>
<p>CANH and CANL of transceiver is attached to (pin2 and pin7) DB9 connector. For DB9 Connector pinout for CAN, refer : <a class="reference external" href="https://documentation.help/NI-CAN/High-Speed_CAN_Pinout_Cable.html">https://documentation.help/NI-CAN/High-Speed_CAN_Pinout_Cable.html</a></p>
</li>
<li><p class="first">PCAN-View software run on development computer is to analyze the CAN network to check for the protocal conformity and errors.</p>
<p>Refer : <a class="reference external" href="https://www.peak-system.com/PCAN-View.242.0.html?&amp;L=1">https://www.peak-system.com/PCAN-View.242.0.html?&amp;L=1</a></p>
<p><a class="reference external" href="/assets/images/pcan-trace.jpeg"><img alt="Image4" src="/assets/images/pcan-trace.jpeg" /></a></p>
</li>
</ol>
<div class="section" id="testbench-setup">
<h2>TestBench Setup</h2>
<blockquote>
<a class="reference external" href="/assets/images/can_testbench.png"><img alt="Image5" src="/assets/images/can_testbench.png" /></a></blockquote>
<p>The testbench results can be seen by referencing Section 2 where 01010101 sent from Litex Console is recieved in PCAN-View In Section 5.</p>
</div>

            </section>

            <section class="post-info">
                <div class="post-share">
                    <a title="Twitter" aria-label="Twitter" class="twitter" href="https://twitter.com/share?text=Milestone 2 Complete&amp;url=https://librecar.dev/2023/12/milestone-two-complete/" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                      <i class="ic ic-twitter" aria-hidden="true"></i><span class="hidden">Twitter</span>
                    </a>
                    <a title="Facebook" aria-label="Facebook" class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://librecar.dev/2023/12/milestone-two-complete/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                      <i class="ic ic-facebook" aria-hidden="true"></i><span class="hidden">Facebook</span>
                    </a>
                    <a title="LinkedIn" aria-label="LinkedIn" class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://librecar.dev/2023/12/milestone-two-complete/&amp;title=Milestone 2 Complete" onclick="window.open(this.href, 'linkedin-share', 'width=930,height=720');return false;">
                      <i class="ic ic-linkedin" aria-hidden="true"></i><span class="hidden">LinkedIn</span>
                    </a>
                    <a title="Email" aria-label="Email" class="email" href="mailto:?subject=Milestone 2 Complete&amp;body=https://librecar.dev/2023/12/milestone-two-complete/">
                      <i class="ic ic-mail" aria-hidden="true"></i><span class="hidden">Email</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="https://librecar.dev/tag/nlnet/">Nlnet</a>                </aside>

                <div class="clear"></div>


                </section>

                <script type="text/javascript">
                    var disqus = 'librecar';
                    var disqus_shortname = 'librecar';
                    var disqus_identifier = '/2023/06/milestone-two-complete.html';
                    var disqus_url = 'https://librecar.dev/2023/12/milestone-two-complete/';
                </script>
                <noscript>Please enable JavaScript to view the comments.</noscript>
                <section class="post-comments">
                        <a id="show-disqus" class="post-comments-activate" data-disqus-identifier="/2023/06/milestone-two-complete.html" >Show Comments</a>
                    <div id="disqus_thread"></div>
                </section>

                <aside class="post-nav">
                    <a class="post-nav-prev" href="https://librecar.dev/2023/06/milestone-one-complete/">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-right"></i>
                                <h2 class="post-nav-title">Milestone 1 Complete</h2>
                            <p class="post-nav-excerpt">CTUCAN Controller for Linux We updated linux-on-litex kernel config to enable CTUCAN...</p>
                        </section>
                    </a>
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">
        </section>
      </div>
    </footer>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <script type="text/javascript" src="https://librecar.dev/theme/js/script.js"></script>

    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-3546274-12"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-3546274-12', { 'anonymize_ip': true });
    </script>
<script type="text/javascript">
    var disqus_shortname = 'librecar';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>